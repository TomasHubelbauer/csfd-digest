{"version":3,"sources":["index.tsx","App.tsx"],"names":["render","useState","Date","dateAndTime","setDateAndTime","cinemas","setCinemas","localStorage","getItem","JSON","parse","selectedCinemas","setSelectedCinemas","movies","setMovies","error","setError","useEffect","a","fetch","response","json","sort","b","screenings","handleCinemaInputChange","event","newSelectedCinemas","filter","c","currentTarget","id","checked","push","setItem","stringify","toString","selectedCinemaIndices","map","indexOf","filteredMovies","m","find","includes","alt","src","href","target","rel","key","type","onChange","htmlFor","length","date","movie","className","name","posterUrl","document","getElementById"],"mappings":"iNAKAA,iBAAO,mBCwCQ,WAAe,MAEUC,mBAAe,IAAIC,MAF7B,mBAErBC,EAFqB,KAERC,EAFQ,OAGEH,mBAAmB,IAHrB,mBAGrBI,EAHqB,KAGZC,EAHY,OAIkBL,mBAAmBM,aAAaC,QAAQ,oBAAsBC,KAAKC,MAAMH,aAAaC,QAAQ,qBAAwB,IAJxI,mBAIrBG,EAJqB,KAIJC,EAJI,OAKAX,mBAAuB,IALvB,mBAKrBY,EALqB,KAKbC,EALa,OAMFb,qBANE,mBAMrBc,EANqB,KAMdC,EANc,KAO5BC,qBAAU,WACH,cAAAC,EAAA,0CAAAA,EAAA,+EAEsBC,MAA+D,kBAFrF,cAEKC,EAFL,gBAGoDA,EAASC,OAH7D,gBAGOlB,EAHP,EAGOA,YAAaE,EAHpB,EAGoBA,SAASQ,EAH7B,EAG6BA,QAGvBS,MAAK,SAACJ,EAAGK,GAAJ,OAAUA,EAAEC,WAAaN,EAAEM,cAEvCpB,EAAe,IAAIF,KAAKC,IACxBG,EAAWD,GACXS,EAAUD,GAVT,kDAYDG,EAAS,EAAD,IAZP,+DAiBP,IAAMS,EAAgE,SAAAC,GACpE,IAAIC,EAAqBhB,EAAgBiB,QAAO,SAAAC,GAAC,OAAIA,IAAMH,EAAMI,cAAcC,MAC3EL,EAAMI,cAAcE,SACtBL,EAAmBM,KAAKP,EAAMI,cAAcC,IAG9CnB,EAAmBe,GACnBpB,aAAa2B,QAAQ,mBAAoBzB,KAAK0B,UAAUR,KAG1D,GAAIZ,EACF,OACE,6BAAMA,EAAMqB,YAIhB,IAAMC,EAAwB1B,EAAgB2B,KAAI,SAAAT,GAAC,OAAIxB,EAAQkC,QAAQV,MACjEW,EAAiB3B,EAAOe,QAAO,SAAAa,GAAC,OAAIA,EAAEpC,QAAQqC,MAAK,SAAAb,GAAC,OAAIQ,EAAsBM,SAASd,SAC7F,OACE,6BACE,6CACA,sCAEE,yBAAKe,IAAI,GAAGC,IAAI,uCAChB,uBAAGC,KAAK,yBAAyBC,OAAO,SAASC,IAAI,uBAArD,oBAHF,IAKE,uBAAGF,KAAK,4DAA4DC,OAAO,SAASC,IAAI,uBAAxF,WAEF,6BACG3C,EAAQiC,KAAI,SAAAT,GAAC,OACZ,kBAAC,WAAD,CAAUoB,IAAKpB,GACb,2BAAOqB,KAAK,WAAWlB,QAASrB,EAAgBgC,SAASd,GAAIE,GAAIF,EAAGsB,SAAU1B,IAC9E,2BAAO2B,QAASvB,GAAIA,QAI1B,2BAAIlB,EAAgB0C,OAApB,UAAmC1C,EAAgB0C,OAAS,EAAI,IAAM,GAAtE,aACA,2BAAIb,EAAea,OAAnB,KAA6BxC,EAAOwC,OAApC,8BAAwE,kBAAC,IAAD,CAASC,KAAMnD,IAAvF,KACCqC,EAAeF,KAAI,SAAAiB,GAAK,OACvB,yBAAKC,UAAU,SAASP,IAAKM,EAAMxB,IACjC,yBAAKa,IAAG,UAAKW,EAAME,KAAX,WAA0BZ,IAAKU,EAAMG,UAAY,UACxDH,EAAME,YD1GV,MAASE,SAASC,eAAe,U","file":"static/js/main.f66d3566.chunk.js","sourcesContent":["import './index.css';\nimport React from 'react';\nimport { render } from 'react-dom';\nimport App from './App';\n\nrender(<App />, document.getElementById('root'));\n","import './App.css';\nimport React, { ChangeEventHandler, useEffect, useState, Fragment } from 'react';\nimport TimeAgo from 'react-timeago';\n\ntype IndexMovie = {\n  id: string;\n  url: string;\n  name: string;\n  year: number;\n  posterUrl: string;\n  cinemas: number[];\n  screenings: number;\n};\n\ntype Movie = {\n  id: string;\n  url: string;\n  name: string;\n  year: number;\n  screenings: {\n    [cinema: string]: Date[];\n  };\n  content: string;\n  imdbUrl: string;\n  posterUrl: string;\n  trailerUrl: string;\n};\n\ntype Data = {\n  dateAndTime: Date;\n  cinemas: string[];\n  movies: IndexMovie[];\n};\n\ntype AppProps = {};\n\ntype AppState = {\n  data:\n  | { type: 'loading' }\n  | { type: 'success', data: Data }\n  | { type: 'error', error: Error }\n  ;\n  selectedCinemas: string[];\n};\n\nexport default function App() {\n  // TODO: Add a loading state\n  const [dateAndTime, setDateAndTime] = useState<Date>(new Date());\n  const [cinemas, setCinemas] = useState<string[]>([]);\n  const [selectedCinemas, setSelectedCinemas] = useState<string[]>(localStorage.getItem('selected-cinemas') ? JSON.parse(localStorage.getItem('selected-cinemas')!) : []);\n  const [movies, setMovies] = useState<IndexMovie[]>([]);\n  const [error, setError] = useState<Error>();\n  useEffect(() => {\n    void async function () {\n      try {\n        const response = await fetch(process.env.NODE_ENV === 'development' ? 'data/_.json' : '../data/_.json');\n        const { dateAndTime, cinemas, movies }: Data = await response.json();\n\n        // Sort movies by the number of screenings as a proxy for popularity\n        movies.sort((a, b) => b.screenings - a.screenings)\n\n        setDateAndTime(new Date(dateAndTime));\n        setCinemas(cinemas);\n        setMovies(movies);\n      } catch (error) {\n        setError(error);\n      }\n    }()\n  });\n\n  const handleCinemaInputChange: ChangeEventHandler<HTMLInputElement> = event => {\n    let newSelectedCinemas = selectedCinemas.filter(c => c !== event.currentTarget.id);\n    if (event.currentTarget.checked) {\n      newSelectedCinemas.push(event.currentTarget.id);\n    }\n\n    setSelectedCinemas(newSelectedCinemas);\n    localStorage.setItem('selected-cinemas', JSON.stringify(newSelectedCinemas));\n  };\n\n  if (error) {\n    return (\n      <div>{error.toString()}</div>\n    );\n  }\n\n  const selectedCinemaIndices = selectedCinemas.map(c => cinemas.indexOf(c));\n  const filteredMovies = movies.filter(m => m.cinemas.find(c => selectedCinemaIndices.includes(c)));\n  return (\n    <div>\n      <h1>Prague Cinema</h1>\n      <p>\n        Built by\n        <img alt=\"\" src=\"https://hubelbauer.net/favicon.ico\" />\n        <a href=\"https://hubelbauer.net\" target=\"_blank\" rel=\"noopener noreferrer\">Tomas Hubelbauer</a>\n        .\n        <a href=\"https://github.com/TomasHubelbauer/puppeteer-csfd-scraper\" target=\"_blank\" rel=\"noopener noreferrer\">GitHub</a>\n      </p>\n      <div>\n        {cinemas.map(c => (\n          <Fragment key={c}>\n            <input type=\"checkbox\" checked={selectedCinemas.includes(c)} id={c} onChange={handleCinemaInputChange} />\n            <label htmlFor={c}>{c}</label>\n          </Fragment>\n        ))}\n      </div>\n      <p>{selectedCinemas.length} cinema{selectedCinemas.length > 1 ? 's' : ''} selected</p>\n      <p>{filteredMovies.length} ({movies.length}) movies: (last updated&nbsp;<TimeAgo date={dateAndTime} />)</p>\n      {filteredMovies.map(movie => (\n        <div className=\"cinema\" key={movie.id}>\n          <img alt={`${movie.name} poster`} src={movie.posterUrl + '?h360'} />\n          {movie.name}\n        </div>\n      ))}\n    </div>\n  );\n}\n"],"sourceRoot":""}